
* 恶意市场签名：签名很乱无法理解，夹杂资产窃取指令
* 钓鱼攻击： 引导点击链接窃取资产
* 虚假功能费用： 交易请求隐藏某种功能的费用

### 攻击

### 重入攻击

* 普通重入攻击
    * 被攻击的合约调用了攻击合约的外部函数，并转移了执行流
    * 攻击合约的函数，再次调用被攻击合约的漏洞函数
    * 这样可以实现多次提取资金
    * 调用withdraw，在receive函数内重复调用

    * **防御:**
        * withdraw
            * 检查余额
            * 设置balance = 0
            * 再进行打款操作
        * OpenZeppelin 提供的 ReentrancyGuard （重入守卫）可能会导致gas提高

* 跨函数重入攻击
    * 原因是多个函数共享一个状态变量
    * Checks-Effects-Interactions（检查-效果-交互） 进行防范


### ApproveScam 授权欺骗
* 如果授权函数（approve）的金额过大
* 谨慎使用 approve
* 及时撤销授权： approve（sender,0);


### 闪电贷

> 出借人实现 IERC3156FlashLender, 接受者实现 IERC3156FlashBorrower

* 借助ERC3156 强化安全


### DOS攻击
> 会导致节点、区块链网络不可用

* 攻击目标：
    * 节点 DOS 攻击： 主要是消耗资源，降低可用性、健壮性
    * 共识层的DOS： 通过算力优势，完成主线分叉
    * 交易的DOS： 提交大量无效交易
    * 对合约的DOS： 利用合约逻辑漏洞，可能会锁资金，合约失效

* 防御措施：
    * 避免合约层面的DOS漏洞


### 三明治攻击
* 主要发生在Dex 交易所
* 意思是两个恶意交易请求中夹杂了一个正常交易
* 使用 LibSubmarine 避免

### 签名重放攻击
* 攻击者利用之前使用过的签名，绕过合约攻击
* 类型
    * 普通重放： 重复使用同一签名多次
    * 跨链重放：同一个签名在不同链重放
    * 参数缺失： 签名未包含所有参数
    * 无到期时间

* 防范：
    * 使用nonce
    * 增加链id与时间戳

### 整数溢出
* 使用openzepplin 的math库


### 中间人攻击
* tx.origin 交易发起者，不能用这个，应该用msg.sender


### 舍入误差
* 先乘后除
* 使用OpenZepplin的SafeMath


### 合约升级导致的漏洞
* Slot漏洞
    * 覆盖逻辑合约地址为攻击者合约的地址
    * 应当使用常量

